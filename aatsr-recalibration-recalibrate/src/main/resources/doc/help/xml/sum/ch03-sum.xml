<chapter id="sum.aatsrrecal">    <title>AATSR Recalibration</title>	<para>	</para>        <sect1 id="sum.aatsrrecal.refl">            <title>Recalibration of AATSR Reflectances</title>            <para>                          </para>            <sect2 id="sum.aatsrrecal.refl.nonlinearity">                <title>Nonlinearity Correction for the 1.6um channel</title>                <para>                    To find out if nonlinearity correction has already been applied, use name of GC1 file,                    which is given in DSD.32 metadata of the AATSR product:                </para>                <para>                    If the GC1 file name is 'ATS_GC1_AXVIEC20020123_073430_20020101_000000_20200101_000000',                    nonlinearity correction has not yet been applied:                    <itemizedlist>                        <listitem>                            Convert 1.6um reflectance back to raw signal (volts) using linear conversion                            <programlisting>                                volts = -0.816 * (reflectance/100.0) / 0.192;                            </programlisting>                        </listitem>                        <listitem>                            Convert 1.6um raw signal to a corrected reflectance using non-linear conversion function with                            nonlinearity coefficients from pre-launch calibration:                            <programlisting>                                correctedReflectance = 100.0 * Math.PI *                                                        (A[0] +                                                         A[1]*volts +                                                         A[2]*volts*volts +                                                         A[3]*volts*volts*volts) / 1.553;                            </programlisting>                            with the nonlinearity coefficients from pre-launch calibration:                            <programlisting>                                final double[] A = new double[]{-0.000027, -0.1093,                                                                0.009393, 0.001013};                            </programlisting>                        </listitem>                    </itemizedlist>                </para>                <para>                    If nonlinearity correction has already been applied (any other GC1 file name), the input                    reflectances are not changed within this module.                </para>            </sect2>            <sect2 id="sum.aatsrrecal.refl.removeexist">                <title>Removal of Existing Long-Term Drift</title>                <para>                </para>                    First, it need to be checked which drift correction had been applied.                    For this, the time information in the name of the VC1 file (which is given in DSD.31 metadata of the                    AATSR product) is used:                    <itemizedlist>                        <listitem>                            If the time in the VC1 file name is before 29-NOV-2005 13:20:26, no drift correction had been applied.                        </listitem>                        <listitem>                            If the time in the VC1 file name is between 29-NOV-2005 13:20:26 and 18-DEC-2006 20:14:15,                            an exponential drift correction had been applied.                        </listitem>                        <listitem>                            If the time in the VC1 file name is after 18-DEC-2006 20:14:15,                            a thin film drift correction had been applied.                        </listitem>                    </itemizedlist>                <para>                    An exponential drift to be removed is expressed as                    <programlisting>                        drift = Math.exp(K[iChannel] * tDiff / 365.0);                    </programlisting>                    where tdiff is the time difference between sensing start and Envisat launch time, and K are                    the yearly drift rates for exponential drift:                    <programlisting>                        final double[] K = new double[]{0.034, 0.021, 0.013, 0.002};                    </programlisting>                </para>                <para>                    A thin film drift to be removed is expressed as                    <programlisting>                        drift = 1.0 + A[iChannel][0] * s * s;                    </programlisting>                    where A are the thin film drift model coefficients                    <programlisting>                        final double[][] A = new double[][]{{0.083, 1.5868E-3},                                                            {0.056, 1.2374E-3},                                                            {0.041, 9.6111E-4}};                    </programlisting>                </para>                <para>                    Finally, multiplying the drift gives the original, uncorrected reflectances:                    <programlisting>                        uncorrectedReflectance = reflectance * drift;                    </programlisting>                </para>            </sect2>            <sect2 id="sum.aatsrrecal.refl.addnew">                <title>Application of new Long-Term Drift</title>                <para>                    The new drift correction is then performed using a look up table to obtain the drift measurement                    for a given channel and acquisition time. A linear interpolation is applied on the drift values                    in the table to exactly match the acquisiton time (the time interval in the table is usually 24 hours).                </para>                <para>                    A snippet of a drift correction lookup table is given in the Appendix.                </para>                <para>                    Finally, dividing by the drift gives the corrected reflectances:                    <programlisting>                        correctedReflectance = reflectance / drift;                    </programlisting>                </para>            </sect2>        </sect1></chapter>